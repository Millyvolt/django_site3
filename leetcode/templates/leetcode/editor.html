<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Code Editor - LeetCode Problems</title>
    
    <!-- CodeMirror CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/theme/monokai.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/theme/material.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/theme/dracula.min.css">
    
    <!-- Custom Editor Styles -->
    {% load static %}
    <link rel="stylesheet" href="{% static 'leetcode/css/editor.css' %}">
    
    <!-- CodeMirror JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/edit/matchbrackets.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/edit/closebrackets.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/clike/clike.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/python/python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/javascript/javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/xml/xml.min.js"></script>
</head>
<body>
    <div class="header">
        <div class="header-left">
            <h1 id="problem-title">Code Editor</h1>
            <span id="difficulty-badge" class="difficulty-badge">Easy</span>
            <!-- <div class="question-selector">
                <button class="question-btn active" onclick="switchQuestion('1')">Two Sum</button>
                <button class="question-btn" onclick="switchQuestion('2')">Add Two Numbers</button>
                <button class="question-btn" onclick="switchQuestion('3')">Longest Substring</button>
            </div> -->
        </div>
        
        <!-- User Info Section -->
        <div class="user-info">
            {% if user.is_authenticated %}
                {% load static %}
                <a href="{% url 'profile' %}" class="user-link">
                    <img src="{{ user.userprofile.get_profile_image_url }}?v={{ user.userprofile.updated_at|date:'U' }}" alt="Profile" class="user-avatar">
                    <div class="username">{{ user.username }}</div>
                </a>
                <div class="auth-links">
                    <a href="{% url 'logout' %}" class="logout">Logout</a>
                </div>
            {% else %}
                <div class="auth-links">
                    <a href="{% url 'login' %}" class="login">Login</a>
                    <a href="{% url 'register' %}" class="register">Register</a>
                </div>
            {% endif %}
        </div>
        <a href="{% url 'leetcode:question_selection' %}" class="back-link">‚Üê Back to Problems</a>
    </div>
    
    <div class="main-container">
        <div class="problem-panel">
            <div class="problem-section">
                <h3>Problem Description</h3>
                <p id="problem-description">Loading...</p>
            </div>
            
            <div class="problem-section">
                <h3>Examples</h3>
                <div id="problem-examples">Loading...</div>
            </div>
            
            <div class="problem-section constraints">
                <h3>Constraints</h3>
                <ul id="problem-constraints">Loading...</ul>
            </div>
        </div>
        
        <div class="editor-panel">
            {% csrf_token %}
            <div class="editor-toolbar">
                <div class="language-selector">
                    <label for="languageSelect">Language:</label>
                    <select id="languageSelect" onchange="changeLanguage()">
                        <option value="cpp">C++</option>
                        <option value="python3">Python 3</option>
<!--                        <option value="java">Java</option>
                        <option value="javascript">JavaScript</option> -->
                    </select>
                    
                    <label for="themeSelect">Theme:</label>
                    <select id="themeSelect" onchange="changeTheme()">
                        <option value="default">Default</option>
                        <option value="monokai">Monokai</option>
                        <option value="material">Material</option>
                        <option value="dracula">Dracula</option>
                    </select>
                </div>
                <div class="editor-buttons">
                    <!-- <button class="btn btn-warning" onclick="resetCode()">Reset</button> -->
                    <button class="btn btn-primary" onclick="runCode()">Run Code</button>
                    <!-- <button class="btn btn-success" onclick="submitCode()">Submit</button> -->
                    <!-- <button class="btn btn-info" onclick="fetchCppTemplateFromLeetCode(currentQuestionId)" id="fetchCppBtn" title="Fetch C++ template from LeetCode">üîß Get C++ Template</button> -->
                    <button class="btn btn-info" onclick="toggleMobileView()" id="mobileBtn">üì± Mobile</button>
                    <button class="btn btn-info" onclick="toggleFullscreen()" id="fullscreenBtn">‚õ∂ Full Screen</button>
                    <button class="btn btn-info" onclick="toggleOutputPanel()" id="outputToggleBtn" title="Toggle Output Panel">üìã Output</button>
                </div>
                <div class="status-indicator">
                    <span id="status">Ready to code</span>
                    <span class="shortcut-hint" title="Keyboard shortcuts: Ctrl+/ to comment, Ctrl+Enter for new line">‚å®Ô∏è Ctrl+/</span>
                </div>
            </div>
            
            <div id="codeEditor" class="code-editor">{{ current_problem.template }}</div>
<!--           
            <div class="input-section">
                <label for="inputField">Input (optional):</label>
                <textarea id="inputField" class="input-field" placeholder="Enter test input here..."></textarea>
            </div>
-->            
            <div id="outputPanel" class="output-panel">
                <div>Output will appear here...</div>
            </div>
        </div>
    </div>
    
    <!-- Template Variables for JavaScript -->
    <script>
        // Template variables that need to be available to the external JS
        window.TEMPLATE_DATA = {
            problems: JSON.parse('{{ problems|escapejs }}'),
            currentQuestionId: '{{ current_question_id }}',
            currentTitleSlug: '{{ current_title_slug|default_if_none:"" }}',
            fetchCppTemplateUrl: '{% url "leetcode:fetch_cpp_template" %}',
            compileUrl: '{% url "leetcode:compile_code" %}'
        };
    </script>
    
    <!-- Custom Editor JavaScript -->
    <script src="{% static 'leetcode/js/editor.js' %}"></script>
</body>
</html>
